[2015-05-30 16:52:19,466] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
[2015-05-30 16:53:05,204] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
[2015-05-30 16:53:19,525] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
[2015-05-30 16:53:30,002] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
[2015-05-30 16:55:02,665] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
[2015-05-30 16:55:08,681] INFO [Controller 0]: Controller starting up (kafka.controller.KafkaController)
[2015-05-30 16:55:08,712] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2015-05-30 16:55:08,712] INFO [Controller 0]: Initialized controller epoch to 2 and zk version 1 (kafka.controller.KafkaController)
[2015-05-30 16:55:08,744] INFO [Controller 0]: Controller 0 incremented epoch to 3 (kafka.controller.KafkaController)
[2015-05-30 16:55:08,791] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2015-05-30 16:55:08,791] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2015-05-30 16:55:08,791] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2015-05-30 16:55:08,791] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2015-05-30 16:55:08,791] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2015-05-30 16:55:08,806] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2015-05-30 16:55:08,806] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2015-05-30 16:55:08,806] INFO [Controller 0]: List of topics ineligible for deletion: my-repilcated-topic,test (kafka.controller.KafkaController)
[2015-05-30 16:55:08,806] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-05-30 16:55:08,806] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-05-30 16:55:08,806] INFO [Controller 0]: Current list of topics in the cluster: Set(test, my-repilcated-topic) (kafka.controller.KafkaController)
[2015-05-30 16:55:08,806] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=my-repilcated-topic,Partition=0,Replica=2] -> ReplicaDeletionIneligible, [Topic=test,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=my-repilcated-topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=my-repilcated-topic,Partition=0,Replica=1] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2015-05-30 16:55:08,822] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [my-repilcated-topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 16:55:08,837] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 16:55:08,837] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([my-repilcated-topic,0] -> OfflinePartition, [test,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2015-05-30 16:55:08,837] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 3 (kafka.controller.KafkaController)
[2015-05-30 16:55:08,853] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2015-05-30 16:55:08,853] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2015-05-30 16:55:08,853] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2015-05-30 16:55:08,853] INFO [Controller 0]: Controller startup complete (kafka.controller.KafkaController)
[2015-05-30 16:55:08,884] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-05-30 16:55:08,916] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-05-30 16:55:08,916] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2015-05-30 16:55:08,931] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to id:0,host:MININT-4IL6B3T.fareast.corp.microsoft.com,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-05-30 16:55:08,931] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2015-05-30 16:55:08,931] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-05-30 16:55:08,947] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=my-repilcated-topic,Partition=0,Replica=0],[Topic=test,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2015-05-30 16:55:09,009] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [my-repilcated-topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 16:55:09,009] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":2,"isr":[0]} for offline partition [my-repilcated-topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 16:55:09,025] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([my-repilcated-topic,0] -> (Leader:0,ISR:0,LeaderEpoch:2,ControllerEpoch:3), [test,0] -> (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:2)) (kafka.controller.PartitionStateMachine)
[2015-05-30 16:55:09,041] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [test,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 16:55:09,041] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":1,"isr":[0]} for offline partition [test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 16:55:09,041] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([my-repilcated-topic,0] -> (Leader:0,ISR:0,LeaderEpoch:2,ControllerEpoch:3), [test,0] -> (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:3)) (kafka.controller.PartitionStateMachine)
[2015-05-30 16:55:13,869] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-05-30 16:55:13,869] DEBUG [Controller 0]: preferred replicas by broker Map(1 -> Map([my-repilcated-topic,0] -> List(1, 2, 0)), 0 -> Map([test,0] -> List(0))) (kafka.controller.KafkaController)
[2015-05-30 16:55:13,869] DEBUG [Controller 0]: topics not in preferred replica Map([my-repilcated-topic,0] -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2015-05-30 16:55:13,885] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 1.000000 (kafka.controller.KafkaController)
[2015-05-30 16:55:13,885] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-05-30 16:55:13,885] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-05-30 16:57:25,737] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children test,my-repilcated-topic,kafkatopic (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2015-05-30 16:57:25,737] INFO [TopicChangeListener on Controller 0]: New topics: [Set(kafkatopic)], deleted topics: [Set()], new partition replica assignment [Map([kafkatopic,0] -> List(0))] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2015-05-30 16:57:25,752] INFO [Controller 0]: New topic creation callback for [kafkatopic,0] (kafka.controller.KafkaController)
[2015-05-30 16:57:25,752] INFO [Controller 0]: New partition creation callback for [kafkatopic,0] (kafka.controller.KafkaController)
[2015-05-30 16:57:25,752] INFO [Partition state machine on Controller 0]: Invoking state change to NewPartition for partitions [kafkatopic,0] (kafka.controller.PartitionStateMachine)
[2015-05-30 16:57:25,752] INFO [Replica state machine on controller 0]: Invoking state change to NewReplica for replicas [Topic=kafkatopic,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2015-05-30 16:57:25,752] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [kafkatopic,0] (kafka.controller.PartitionStateMachine)
[2015-05-30 16:57:25,752] DEBUG [Partition state machine on Controller 0]: Live assigned replicas for partition [kafkatopic,0] are: [List(0)] (kafka.controller.PartitionStateMachine)
[2015-05-30 16:57:25,752] DEBUG [Partition state machine on Controller 0]: Initializing leader and isr for partition [kafkatopic,0] to (Leader:0,ISR:0,LeaderEpoch:0,ControllerEpoch:3) (kafka.controller.PartitionStateMachine)
[2015-05-30 16:57:25,768] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=kafkatopic,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2015-05-30 17:00:13,887] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-05-30 17:00:13,903] DEBUG [Controller 0]: preferred replicas by broker Map(1 -> Map([my-repilcated-topic,0] -> List(1, 2, 0)), 0 -> Map([kafkatopic,0] -> List(0), [test,0] -> List(0))) (kafka.controller.KafkaController)
[2015-05-30 17:00:13,903] DEBUG [Controller 0]: topics not in preferred replica Map([my-repilcated-topic,0] -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2015-05-30 17:00:13,903] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 1.000000 (kafka.controller.KafkaController)
[2015-05-30 17:00:13,903] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-05-30 17:00:13,903] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-05-30 17:05:13,914] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-05-30 17:05:13,914] DEBUG [Controller 0]: preferred replicas by broker Map(1 -> Map([my-repilcated-topic,0] -> List(1, 2, 0)), 0 -> Map([kafkatopic,0] -> List(0), [test,0] -> List(0))) (kafka.controller.KafkaController)
[2015-05-30 17:05:13,914] DEBUG [Controller 0]: topics not in preferred replica Map([my-repilcated-topic,0] -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2015-05-30 17:05:13,914] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 1.000000 (kafka.controller.KafkaController)
[2015-05-30 17:05:13,914] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-05-30 17:05:13,914] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-05-30 17:10:13,922] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-05-30 17:10:13,922] DEBUG [Controller 0]: preferred replicas by broker Map(1 -> Map([my-repilcated-topic,0] -> List(1, 2, 0)), 0 -> Map([kafkatopic,0] -> List(0), [test,0] -> List(0))) (kafka.controller.KafkaController)
[2015-05-30 17:10:13,922] DEBUG [Controller 0]: topics not in preferred replica Map([my-repilcated-topic,0] -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2015-05-30 17:10:13,922] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 1.000000 (kafka.controller.KafkaController)
[2015-05-30 17:10:13,922] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-05-30 17:10:13,922] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-05-30 17:15:13,934] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-05-30 17:15:13,934] DEBUG [Controller 0]: preferred replicas by broker Map(1 -> Map([my-repilcated-topic,0] -> List(1, 2, 0)), 0 -> Map([kafkatopic,0] -> List(0), [test,0] -> List(0))) (kafka.controller.KafkaController)
[2015-05-30 17:15:13,934] DEBUG [Controller 0]: topics not in preferred replica Map([my-repilcated-topic,0] -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2015-05-30 17:15:13,934] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 1.000000 (kafka.controller.KafkaController)
[2015-05-30 17:15:13,934] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-05-30 17:15:13,934] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-05-30 17:20:13,948] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-05-30 17:20:13,948] DEBUG [Controller 0]: preferred replicas by broker Map(1 -> Map([my-repilcated-topic,0] -> List(1, 2, 0)), 0 -> Map([kafkatopic,0] -> List(0), [test,0] -> List(0))) (kafka.controller.KafkaController)
[2015-05-30 17:20:13,948] DEBUG [Controller 0]: topics not in preferred replica Map([my-repilcated-topic,0] -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2015-05-30 17:20:13,948] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 1.000000 (kafka.controller.KafkaController)
[2015-05-30 17:20:13,948] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-05-30 17:20:13,948] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-05-30 17:25:13,955] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-05-30 17:25:13,955] DEBUG [Controller 0]: preferred replicas by broker Map(1 -> Map([my-repilcated-topic,0] -> List(1, 2, 0)), 0 -> Map([kafkatopic,0] -> List(0), [test,0] -> List(0))) (kafka.controller.KafkaController)
[2015-05-30 17:25:13,955] DEBUG [Controller 0]: topics not in preferred replica Map([my-repilcated-topic,0] -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2015-05-30 17:25:13,955] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 1.000000 (kafka.controller.KafkaController)
[2015-05-30 17:25:13,955] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-05-30 17:25:13,955] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-05-30 17:30:13,962] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-05-30 17:30:13,962] DEBUG [Controller 0]: preferred replicas by broker Map(1 -> Map([my-repilcated-topic,0] -> List(1, 2, 0)), 0 -> Map([kafkatopic,0] -> List(0), [test,0] -> List(0))) (kafka.controller.KafkaController)
[2015-05-30 17:30:13,962] DEBUG [Controller 0]: topics not in preferred replica Map([my-repilcated-topic,0] -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2015-05-30 17:30:13,962] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 1.000000 (kafka.controller.KafkaController)
[2015-05-30 17:30:13,962] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-05-30 17:30:13,962] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-05-30 17:35:13,977] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-05-30 17:35:13,977] DEBUG [Controller 0]: preferred replicas by broker Map(1 -> Map([my-repilcated-topic,0] -> List(1, 2, 0)), 0 -> Map([kafkatopic,0] -> List(0), [test,0] -> List(0))) (kafka.controller.KafkaController)
[2015-05-30 17:35:13,977] DEBUG [Controller 0]: topics not in preferred replica Map([my-repilcated-topic,0] -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2015-05-30 17:35:13,977] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 1.000000 (kafka.controller.KafkaController)
[2015-05-30 17:35:13,977] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-05-30 17:35:13,977] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-05-30 17:40:13,984] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-05-30 17:40:13,984] DEBUG [Controller 0]: preferred replicas by broker Map(1 -> Map([my-repilcated-topic,0] -> List(1, 2, 0)), 0 -> Map([kafkatopic,0] -> List(0), [test,0] -> List(0))) (kafka.controller.KafkaController)
[2015-05-30 17:40:13,984] DEBUG [Controller 0]: topics not in preferred replica Map([my-repilcated-topic,0] -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2015-05-30 17:40:13,984] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 1.000000 (kafka.controller.KafkaController)
[2015-05-30 17:40:13,984] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-05-30 17:40:13,984] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-05-30 17:45:13,992] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-05-30 17:45:13,992] DEBUG [Controller 0]: preferred replicas by broker Map(1 -> Map([my-repilcated-topic,0] -> List(1, 2, 0)), 0 -> Map([kafkatopic,0] -> List(0), [test,0] -> List(0))) (kafka.controller.KafkaController)
[2015-05-30 17:45:13,992] DEBUG [Controller 0]: topics not in preferred replica Map([my-repilcated-topic,0] -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2015-05-30 17:45:13,992] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 1.000000 (kafka.controller.KafkaController)
[2015-05-30 17:45:13,992] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-05-30 17:45:13,992] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-05-30 17:50:14,001] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-05-30 17:50:14,001] DEBUG [Controller 0]: preferred replicas by broker Map(1 -> Map([my-repilcated-topic,0] -> List(1, 2, 0)), 0 -> Map([kafkatopic,0] -> List(0), [test,0] -> List(0))) (kafka.controller.KafkaController)
[2015-05-30 17:50:14,001] DEBUG [Controller 0]: topics not in preferred replica Map([my-repilcated-topic,0] -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2015-05-30 17:50:14,001] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 1.000000 (kafka.controller.KafkaController)
[2015-05-30 17:50:14,001] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-05-30 17:50:14,001] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-05-30 17:55:14,015] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-05-30 17:55:14,015] DEBUG [Controller 0]: preferred replicas by broker Map(1 -> Map([my-repilcated-topic,0] -> List(1, 2, 0)), 0 -> Map([kafkatopic,0] -> List(0), [test,0] -> List(0))) (kafka.controller.KafkaController)
[2015-05-30 17:55:14,015] DEBUG [Controller 0]: topics not in preferred replica Map([my-repilcated-topic,0] -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2015-05-30 17:55:14,015] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 1.000000 (kafka.controller.KafkaController)
[2015-05-30 17:55:14,015] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-05-30 17:55:14,015] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-05-30 18:00:14,026] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-05-30 18:00:14,042] DEBUG [Controller 0]: preferred replicas by broker Map(1 -> Map([my-repilcated-topic,0] -> List(1, 2, 0)), 0 -> Map([kafkatopic,0] -> List(0), [test,0] -> List(0))) (kafka.controller.KafkaController)
[2015-05-30 18:00:14,042] DEBUG [Controller 0]: topics not in preferred replica Map([my-repilcated-topic,0] -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2015-05-30 18:00:14,042] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 1.000000 (kafka.controller.KafkaController)
[2015-05-30 18:00:14,042] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-05-30 18:00:14,042] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-05-30 18:05:14,040] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-05-30 18:05:14,040] DEBUG [Controller 0]: preferred replicas by broker Map(1 -> Map([my-repilcated-topic,0] -> List(1, 2, 0)), 0 -> Map([kafkatopic,0] -> List(0), [test,0] -> List(0))) (kafka.controller.KafkaController)
[2015-05-30 18:05:14,040] DEBUG [Controller 0]: topics not in preferred replica Map([my-repilcated-topic,0] -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2015-05-30 18:05:14,040] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 1.000000 (kafka.controller.KafkaController)
[2015-05-30 18:05:14,040] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-05-30 18:05:14,040] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-05-30 18:10:14,055] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-05-30 18:10:14,055] DEBUG [Controller 0]: preferred replicas by broker Map(1 -> Map([my-repilcated-topic,0] -> List(1, 2, 0)), 0 -> Map([kafkatopic,0] -> List(0), [test,0] -> List(0))) (kafka.controller.KafkaController)
[2015-05-30 18:10:14,055] DEBUG [Controller 0]: topics not in preferred replica Map([my-repilcated-topic,0] -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2015-05-30 18:10:14,055] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 1.000000 (kafka.controller.KafkaController)
[2015-05-30 18:10:14,055] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-05-30 18:10:14,055] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-05-30 18:15:14,071] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-05-30 18:15:14,071] DEBUG [Controller 0]: preferred replicas by broker Map(1 -> Map([my-repilcated-topic,0] -> List(1, 2, 0)), 0 -> Map([kafkatopic,0] -> List(0), [test,0] -> List(0))) (kafka.controller.KafkaController)
[2015-05-30 18:15:14,071] DEBUG [Controller 0]: topics not in preferred replica Map([my-repilcated-topic,0] -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2015-05-30 18:15:14,071] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 1.000000 (kafka.controller.KafkaController)
[2015-05-30 18:15:14,071] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-05-30 18:15:14,071] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-05-30 18:20:14,082] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-05-30 18:20:14,082] DEBUG [Controller 0]: preferred replicas by broker Map(1 -> Map([my-repilcated-topic,0] -> List(1, 2, 0)), 0 -> Map([kafkatopic,0] -> List(0), [test,0] -> List(0))) (kafka.controller.KafkaController)
[2015-05-30 18:20:14,082] DEBUG [Controller 0]: topics not in preferred replica Map([my-repilcated-topic,0] -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2015-05-30 18:20:14,082] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 1.000000 (kafka.controller.KafkaController)
[2015-05-30 18:20:14,082] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-05-30 18:20:14,082] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-05-30 18:25:14,092] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-05-30 18:25:14,092] DEBUG [Controller 0]: preferred replicas by broker Map(1 -> Map([my-repilcated-topic,0] -> List(1, 2, 0)), 0 -> Map([kafkatopic,0] -> List(0), [test,0] -> List(0))) (kafka.controller.KafkaController)
[2015-05-30 18:25:14,092] DEBUG [Controller 0]: topics not in preferred replica Map([my-repilcated-topic,0] -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2015-05-30 18:25:14,092] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 1.000000 (kafka.controller.KafkaController)
[2015-05-30 18:25:14,092] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-05-30 18:25:14,092] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-05-30 18:30:14,112] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-05-30 18:30:14,112] DEBUG [Controller 0]: preferred replicas by broker Map(1 -> Map([my-repilcated-topic,0] -> List(1, 2, 0)), 0 -> Map([kafkatopic,0] -> List(0), [test,0] -> List(0))) (kafka.controller.KafkaController)
[2015-05-30 18:30:14,112] DEBUG [Controller 0]: topics not in preferred replica Map([my-repilcated-topic,0] -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2015-05-30 18:30:14,112] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 1.000000 (kafka.controller.KafkaController)
[2015-05-30 18:30:14,112] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-05-30 18:30:14,112] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-05-30 18:35:14,110] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-05-30 18:35:14,110] DEBUG [Controller 0]: preferred replicas by broker Map(1 -> Map([my-repilcated-topic,0] -> List(1, 2, 0)), 0 -> Map([kafkatopic,0] -> List(0), [test,0] -> List(0))) (kafka.controller.KafkaController)
[2015-05-30 18:35:14,110] DEBUG [Controller 0]: topics not in preferred replica Map([my-repilcated-topic,0] -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2015-05-30 18:35:14,110] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 1.000000 (kafka.controller.KafkaController)
[2015-05-30 18:35:14,110] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-05-30 18:35:14,110] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-05-30 18:40:14,122] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-05-30 18:40:14,122] DEBUG [Controller 0]: preferred replicas by broker Map(1 -> Map([my-repilcated-topic,0] -> List(1, 2, 0)), 0 -> Map([kafkatopic,0] -> List(0), [test,0] -> List(0))) (kafka.controller.KafkaController)
[2015-05-30 18:40:14,122] DEBUG [Controller 0]: topics not in preferred replica Map([my-repilcated-topic,0] -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2015-05-30 18:40:14,122] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 1.000000 (kafka.controller.KafkaController)
[2015-05-30 18:40:14,122] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-05-30 18:40:14,122] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-05-30 18:45:14,140] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-05-30 18:45:14,140] DEBUG [Controller 0]: preferred replicas by broker Map(1 -> Map([my-repilcated-topic,0] -> List(1, 2, 0)), 0 -> Map([kafkatopic,0] -> List(0), [test,0] -> List(0))) (kafka.controller.KafkaController)
[2015-05-30 18:45:14,140] DEBUG [Controller 0]: topics not in preferred replica Map([my-repilcated-topic,0] -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2015-05-30 18:45:14,140] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 1.000000 (kafka.controller.KafkaController)
[2015-05-30 18:45:14,140] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-05-30 18:45:14,140] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-05-30 18:50:14,140] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-05-30 18:50:14,140] DEBUG [Controller 0]: preferred replicas by broker Map(1 -> Map([my-repilcated-topic,0] -> List(1, 2, 0)), 0 -> Map([kafkatopic,0] -> List(0), [test,0] -> List(0))) (kafka.controller.KafkaController)
[2015-05-30 18:50:14,140] DEBUG [Controller 0]: topics not in preferred replica Map([my-repilcated-topic,0] -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2015-05-30 18:50:14,140] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 1.000000 (kafka.controller.KafkaController)
[2015-05-30 18:50:14,140] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-05-30 18:50:14,140] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-05-30 18:55:14,151] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-05-30 18:55:14,151] DEBUG [Controller 0]: preferred replicas by broker Map(1 -> Map([my-repilcated-topic,0] -> List(1, 2, 0)), 0 -> Map([kafkatopic,0] -> List(0), [test,0] -> List(0))) (kafka.controller.KafkaController)
[2015-05-30 18:55:14,152] DEBUG [Controller 0]: topics not in preferred replica Map([my-repilcated-topic,0] -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2015-05-30 18:55:14,152] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 1.000000 (kafka.controller.KafkaController)
[2015-05-30 18:55:14,152] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-05-30 18:55:14,152] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-05-30 19:00:14,177] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-05-30 19:00:14,177] DEBUG [Controller 0]: preferred replicas by broker Map(1 -> Map([my-repilcated-topic,0] -> List(1, 2, 0)), 0 -> Map([kafkatopic,0] -> List(0), [test,0] -> List(0))) (kafka.controller.KafkaController)
[2015-05-30 19:00:14,177] DEBUG [Controller 0]: topics not in preferred replica Map([my-repilcated-topic,0] -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2015-05-30 19:00:14,177] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 1.000000 (kafka.controller.KafkaController)
[2015-05-30 19:00:14,177] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-05-30 19:00:14,177] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-05-30 19:05:14,188] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-05-30 19:05:14,188] DEBUG [Controller 0]: preferred replicas by broker Map(1 -> Map([my-repilcated-topic,0] -> List(1, 2, 0)), 0 -> Map([kafkatopic,0] -> List(0), [test,0] -> List(0))) (kafka.controller.KafkaController)
[2015-05-30 19:05:14,188] DEBUG [Controller 0]: topics not in preferred replica Map([my-repilcated-topic,0] -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2015-05-30 19:05:14,188] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 1.000000 (kafka.controller.KafkaController)
[2015-05-30 19:05:14,188] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-05-30 19:05:14,188] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-05-30 19:10:14,190] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-05-30 19:10:14,190] DEBUG [Controller 0]: preferred replicas by broker Map(1 -> Map([my-repilcated-topic,0] -> List(1, 2, 0)), 0 -> Map([kafkatopic,0] -> List(0), [test,0] -> List(0))) (kafka.controller.KafkaController)
[2015-05-30 19:10:14,190] DEBUG [Controller 0]: topics not in preferred replica Map([my-repilcated-topic,0] -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2015-05-30 19:10:14,190] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 1.000000 (kafka.controller.KafkaController)
[2015-05-30 19:10:14,190] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-05-30 19:10:14,190] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-05-30 19:15:14,203] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-05-30 19:15:14,203] DEBUG [Controller 0]: preferred replicas by broker Map(1 -> Map([my-repilcated-topic,0] -> List(1, 2, 0)), 0 -> Map([kafkatopic,0] -> List(0), [test,0] -> List(0))) (kafka.controller.KafkaController)
[2015-05-30 19:15:14,203] DEBUG [Controller 0]: topics not in preferred replica Map([my-repilcated-topic,0] -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2015-05-30 19:15:14,203] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 1.000000 (kafka.controller.KafkaController)
[2015-05-30 19:15:14,203] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-05-30 19:15:14,203] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-05-30 19:18:51,401] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
[2015-05-30 19:19:06,144] INFO [Controller 0]: Controller starting up (kafka.controller.KafkaController)
[2015-05-30 19:19:06,170] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2015-05-30 19:19:06,175] INFO [Controller 0]: Initialized controller epoch to 3 and zk version 2 (kafka.controller.KafkaController)
[2015-05-30 19:19:06,181] INFO [Controller 0]: Controller 0 incremented epoch to 4 (kafka.controller.KafkaController)
[2015-05-30 19:19:06,239] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2015-05-30 19:19:06,239] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2015-05-30 19:19:06,239] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2015-05-30 19:19:06,242] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2015-05-30 19:19:06,243] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2015-05-30 19:19:06,243] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2015-05-30 19:19:06,249] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2015-05-30 19:19:06,249] INFO [Controller 0]: List of topics ineligible for deletion: kafkatopic,my-repilcated-topic,test (kafka.controller.KafkaController)
[2015-05-30 19:19:06,251] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-05-30 19:19:06,251] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-05-30 19:19:06,251] INFO [Controller 0]: Current list of topics in the cluster: Set(test, my-repilcated-topic, kafkatopic) (kafka.controller.KafkaController)
[2015-05-30 19:19:06,257] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=my-repilcated-topic,Partition=0,Replica=2] -> ReplicaDeletionIneligible, [Topic=kafkatopic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=test,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=my-repilcated-topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=my-repilcated-topic,Partition=0,Replica=1] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2015-05-30 19:19:06,273] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafkatopic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 19:19:06,287] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [my-repilcated-topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 19:19:06,299] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 19:19:06,305] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([kafkatopic,0] -> OfflinePartition, [my-repilcated-topic,0] -> OfflinePartition, [test,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2015-05-30 19:19:06,312] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 4 (kafka.controller.KafkaController)
[2015-05-30 19:19:06,314] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2015-05-30 19:19:06,315] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2015-05-30 19:19:06,330] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2015-05-30 19:19:06,331] INFO [Controller 0]: Controller startup complete (kafka.controller.KafkaController)
[2015-05-30 19:19:06,357] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-05-30 19:19:06,430] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-05-30 19:19:06,437] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2015-05-30 19:19:06,445] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to id:0,host:MININT-4IL6B3T.fareast.corp.microsoft.com,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-05-30 19:19:06,447] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-05-30 19:19:06,448] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2015-05-30 19:19:06,459] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=kafkatopic,Partition=0,Replica=0],[Topic=my-repilcated-topic,Partition=0,Replica=0],[Topic=test,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2015-05-30 19:19:06,567] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafkatopic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 19:19:06,579] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":1,"isr":[0]} for offline partition [kafkatopic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 19:19:06,652] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafkatopic,0] -> (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:4), [my-repilcated-topic,0] -> (Leader:0,ISR:0,LeaderEpoch:2,ControllerEpoch:3), [test,0] -> (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:3)) (kafka.controller.PartitionStateMachine)
[2015-05-30 19:19:06,665] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [my-repilcated-topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 19:19:06,665] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":3,"isr":[0]} for offline partition [my-repilcated-topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 19:19:06,670] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafkatopic,0] -> (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:4), [my-repilcated-topic,0] -> (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:4), [test,0] -> (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:3)) (kafka.controller.PartitionStateMachine)
[2015-05-30 19:19:06,676] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [test,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 19:19:06,676] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":2,"isr":[0]} for offline partition [test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 19:19:06,689] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafkatopic,0] -> (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:4), [my-repilcated-topic,0] -> (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:4), [test,0] -> (Leader:0,ISR:0,LeaderEpoch:2,ControllerEpoch:4)) (kafka.controller.PartitionStateMachine)
[2015-05-30 19:19:11,335] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-05-30 19:19:11,340] DEBUG [Controller 0]: preferred replicas by broker Map(1 -> Map([my-repilcated-topic,0] -> List(1, 2, 0)), 0 -> Map([kafkatopic,0] -> List(0), [test,0] -> List(0))) (kafka.controller.KafkaController)
[2015-05-30 19:19:11,344] DEBUG [Controller 0]: topics not in preferred replica Map([my-repilcated-topic,0] -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2015-05-30 19:19:11,346] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 1.000000 (kafka.controller.KafkaController)
[2015-05-30 19:19:11,348] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-05-30 19:19:11,348] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-05-30 19:19:46,045] INFO [Controller 0]: Controller starting up (kafka.controller.KafkaController)
[2015-05-30 19:19:46,069] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2015-05-30 19:19:46,077] INFO [Controller 0]: Initialized controller epoch to 4 and zk version 3 (kafka.controller.KafkaController)
[2015-05-30 19:19:46,083] INFO [Controller 0]: Controller 0 incremented epoch to 5 (kafka.controller.KafkaController)
[2015-05-30 19:19:46,137] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2015-05-30 19:19:46,138] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2015-05-30 19:19:46,138] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2015-05-30 19:19:46,140] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2015-05-30 19:19:46,141] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2015-05-30 19:19:46,141] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2015-05-30 19:19:46,145] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2015-05-30 19:19:46,145] INFO [Controller 0]: List of topics ineligible for deletion: kafkatopic,my-repilcated-topic,test (kafka.controller.KafkaController)
[2015-05-30 19:19:46,147] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-05-30 19:19:46,147] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-05-30 19:19:46,147] INFO [Controller 0]: Current list of topics in the cluster: Set(test, my-repilcated-topic, kafkatopic) (kafka.controller.KafkaController)
[2015-05-30 19:19:46,151] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=my-repilcated-topic,Partition=0,Replica=2] -> ReplicaDeletionIneligible, [Topic=kafkatopic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=test,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=my-repilcated-topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=my-repilcated-topic,Partition=0,Replica=1] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2015-05-30 19:19:46,167] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafkatopic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 19:19:46,180] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [my-repilcated-topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 19:19:46,193] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 19:19:46,198] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([kafkatopic,0] -> OfflinePartition, [my-repilcated-topic,0] -> OfflinePartition, [test,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2015-05-30 19:19:46,205] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 5 (kafka.controller.KafkaController)
[2015-05-30 19:19:46,206] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2015-05-30 19:19:46,207] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2015-05-30 19:19:46,220] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2015-05-30 19:19:46,221] INFO [Controller 0]: Controller startup complete (kafka.controller.KafkaController)
[2015-05-30 19:19:46,252] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-05-30 19:19:46,352] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-05-30 19:19:46,354] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2015-05-30 19:19:46,378] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to id:0,host:MININT-4IL6B3T.fareast.corp.microsoft.com,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-05-30 19:19:46,381] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2015-05-30 19:19:46,391] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-05-30 19:19:46,417] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=kafkatopic,Partition=0,Replica=0],[Topic=my-repilcated-topic,Partition=0,Replica=0],[Topic=test,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2015-05-30 19:19:46,483] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafkatopic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 19:19:46,491] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":2,"isr":[0]} for offline partition [kafkatopic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 19:19:46,527] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafkatopic,0] -> (Leader:0,ISR:0,LeaderEpoch:2,ControllerEpoch:5), [my-repilcated-topic,0] -> (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:4), [test,0] -> (Leader:0,ISR:0,LeaderEpoch:2,ControllerEpoch:4)) (kafka.controller.PartitionStateMachine)
[2015-05-30 19:19:46,563] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [my-repilcated-topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 19:19:46,563] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":4,"isr":[0]} for offline partition [my-repilcated-topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 19:19:46,573] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafkatopic,0] -> (Leader:0,ISR:0,LeaderEpoch:2,ControllerEpoch:5), [my-repilcated-topic,0] -> (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:5), [test,0] -> (Leader:0,ISR:0,LeaderEpoch:2,ControllerEpoch:4)) (kafka.controller.PartitionStateMachine)
[2015-05-30 19:19:46,583] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [test,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 19:19:46,584] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":3,"isr":[0]} for offline partition [test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 19:19:46,588] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafkatopic,0] -> (Leader:0,ISR:0,LeaderEpoch:2,ControllerEpoch:5), [my-repilcated-topic,0] -> (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:5), [test,0] -> (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:5)) (kafka.controller.PartitionStateMachine)
[2015-05-30 19:19:51,224] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-05-30 19:19:51,227] DEBUG [Controller 0]: preferred replicas by broker Map(1 -> Map([my-repilcated-topic,0] -> List(1, 2, 0)), 0 -> Map([kafkatopic,0] -> List(0), [test,0] -> List(0))) (kafka.controller.KafkaController)
[2015-05-30 19:19:51,230] DEBUG [Controller 0]: topics not in preferred replica Map([my-repilcated-topic,0] -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2015-05-30 19:19:51,231] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 1.000000 (kafka.controller.KafkaController)
[2015-05-30 19:19:51,232] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-05-30 19:19:51,232] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-05-30 19:24:51,238] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-05-30 19:24:51,239] DEBUG [Controller 0]: preferred replicas by broker Map(1 -> Map([my-repilcated-topic,0] -> List(1, 2, 0)), 0 -> Map([kafkatopic,0] -> List(0), [test,0] -> List(0))) (kafka.controller.KafkaController)
[2015-05-30 19:24:51,240] DEBUG [Controller 0]: topics not in preferred replica Map([my-repilcated-topic,0] -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2015-05-30 19:24:51,241] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 1.000000 (kafka.controller.KafkaController)
[2015-05-30 19:24:51,241] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-05-30 19:24:51,241] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-05-30 19:29:51,253] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-05-30 19:29:51,254] DEBUG [Controller 0]: preferred replicas by broker Map(1 -> Map([my-repilcated-topic,0] -> List(1, 2, 0)), 0 -> Map([kafkatopic,0] -> List(0), [test,0] -> List(0))) (kafka.controller.KafkaController)
[2015-05-30 19:29:51,254] DEBUG [Controller 0]: topics not in preferred replica Map([my-repilcated-topic,0] -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2015-05-30 19:29:51,254] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 1.000000 (kafka.controller.KafkaController)
[2015-05-30 19:29:51,254] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-05-30 19:29:51,254] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-05-30 19:34:51,268] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-05-30 19:34:51,268] DEBUG [Controller 0]: preferred replicas by broker Map(1 -> Map([my-repilcated-topic,0] -> List(1, 2, 0)), 0 -> Map([kafkatopic,0] -> List(0), [test,0] -> List(0))) (kafka.controller.KafkaController)
[2015-05-30 19:34:51,269] DEBUG [Controller 0]: topics not in preferred replica Map([my-repilcated-topic,0] -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2015-05-30 19:34:51,269] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 1.000000 (kafka.controller.KafkaController)
[2015-05-30 19:34:51,269] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-05-30 19:34:51,269] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-05-30 19:35:22,196] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
[2015-05-30 19:39:51,278] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-05-30 19:39:51,279] DEBUG [Controller 0]: preferred replicas by broker Map(1 -> Map([my-repilcated-topic,0] -> List(1, 2, 0)), 0 -> Map([kafkatopic,0] -> List(0), [test,0] -> List(0))) (kafka.controller.KafkaController)
[2015-05-30 19:39:51,279] DEBUG [Controller 0]: topics not in preferred replica Map([my-repilcated-topic,0] -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2015-05-30 19:39:51,279] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 1.000000 (kafka.controller.KafkaController)
[2015-05-30 19:39:51,280] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-05-30 19:39:51,280] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-05-30 19:44:51,287] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-05-30 19:44:51,288] DEBUG [Controller 0]: preferred replicas by broker Map(1 -> Map([my-repilcated-topic,0] -> List(1, 2, 0)), 0 -> Map([kafkatopic,0] -> List(0), [test,0] -> List(0))) (kafka.controller.KafkaController)
[2015-05-30 19:44:51,289] DEBUG [Controller 0]: topics not in preferred replica Map([my-repilcated-topic,0] -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2015-05-30 19:44:51,289] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 1.000000 (kafka.controller.KafkaController)
[2015-05-30 19:44:51,289] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-05-30 19:44:51,290] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-05-30 19:45:06,163] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
[2015-05-30 19:45:27,628] INFO [Controller 0]: Controller starting up (kafka.controller.KafkaController)
[2015-05-30 19:45:27,651] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2015-05-30 19:45:27,658] INFO [Controller 0]: Initialized controller epoch to 5 and zk version 4 (kafka.controller.KafkaController)
[2015-05-30 19:45:27,665] INFO [Controller 0]: Controller 0 incremented epoch to 6 (kafka.controller.KafkaController)
[2015-05-30 19:45:27,719] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2015-05-30 19:45:27,719] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2015-05-30 19:45:27,719] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2015-05-30 19:45:27,722] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2015-05-30 19:45:27,722] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2015-05-30 19:45:27,723] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2015-05-30 19:45:27,727] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2015-05-30 19:45:27,727] INFO [Controller 0]: List of topics ineligible for deletion: kafkatopic,my-repilcated-topic,test (kafka.controller.KafkaController)
[2015-05-30 19:45:27,729] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-05-30 19:45:27,729] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-05-30 19:45:27,729] INFO [Controller 0]: Current list of topics in the cluster: Set(test, my-repilcated-topic, kafkatopic) (kafka.controller.KafkaController)
[2015-05-30 19:45:27,733] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=my-repilcated-topic,Partition=0,Replica=2] -> ReplicaDeletionIneligible, [Topic=kafkatopic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=test,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=my-repilcated-topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=my-repilcated-topic,Partition=0,Replica=1] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2015-05-30 19:45:27,747] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafkatopic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 19:45:27,760] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [my-repilcated-topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 19:45:27,803] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 19:45:27,815] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([kafkatopic,0] -> OfflinePartition, [my-repilcated-topic,0] -> OfflinePartition, [test,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2015-05-30 19:45:27,830] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 6 (kafka.controller.KafkaController)
[2015-05-30 19:45:27,833] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2015-05-30 19:45:27,834] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2015-05-30 19:45:27,917] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2015-05-30 19:45:27,918] INFO [Controller 0]: Controller startup complete (kafka.controller.KafkaController)
[2015-05-30 19:45:27,949] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-05-30 19:45:27,991] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-05-30 19:45:27,996] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2015-05-30 19:45:28,080] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to id:0,host:MININT-4IL6B3T.fareast.corp.microsoft.com,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-05-30 19:45:28,084] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2015-05-30 19:45:28,089] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-05-30 19:45:28,094] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=kafkatopic,Partition=0,Replica=0],[Topic=my-repilcated-topic,Partition=0,Replica=0],[Topic=test,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2015-05-30 19:45:28,132] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafkatopic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 19:45:28,133] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":3,"isr":[0]} for offline partition [kafkatopic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 19:45:28,155] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafkatopic,0] -> (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:6), [my-repilcated-topic,0] -> (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:5), [test,0] -> (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:5)) (kafka.controller.PartitionStateMachine)
[2015-05-30 19:45:28,170] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [my-repilcated-topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 19:45:28,171] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":5,"isr":[0]} for offline partition [my-repilcated-topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 19:45:28,191] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafkatopic,0] -> (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:6), [my-repilcated-topic,0] -> (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:6), [test,0] -> (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:5)) (kafka.controller.PartitionStateMachine)
[2015-05-30 19:45:28,212] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [test,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 19:45:28,213] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":4,"isr":[0]} for offline partition [test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 19:45:28,221] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafkatopic,0] -> (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:6), [my-repilcated-topic,0] -> (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:6), [test,0] -> (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:6)) (kafka.controller.PartitionStateMachine)
[2015-05-30 19:45:32,919] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-05-30 19:45:32,923] DEBUG [Controller 0]: preferred replicas by broker Map(1 -> Map([my-repilcated-topic,0] -> List(1, 2, 0)), 0 -> Map([kafkatopic,0] -> List(0), [test,0] -> List(0))) (kafka.controller.KafkaController)
[2015-05-30 19:45:32,927] DEBUG [Controller 0]: topics not in preferred replica Map([my-repilcated-topic,0] -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2015-05-30 19:45:32,929] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 1.000000 (kafka.controller.KafkaController)
[2015-05-30 19:45:32,931] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-05-30 19:45:32,931] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-05-30 19:50:12,650] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
[2015-05-30 19:50:38,530] INFO [Controller 0]: Controller starting up (kafka.controller.KafkaController)
[2015-05-30 19:50:38,561] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2015-05-30 19:50:38,561] INFO [Controller 0]: Initialized controller epoch to 6 and zk version 5 (kafka.controller.KafkaController)
[2015-05-30 19:50:38,561] INFO [Controller 0]: Controller 0 incremented epoch to 7 (kafka.controller.KafkaController)
[2015-05-30 19:50:38,624] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2015-05-30 19:50:38,624] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2015-05-30 19:50:38,624] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2015-05-30 19:50:38,624] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2015-05-30 19:50:38,624] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2015-05-30 19:50:38,624] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2015-05-30 19:50:38,624] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2015-05-30 19:50:38,624] INFO [Controller 0]: List of topics ineligible for deletion: kafkatopic,my-repilcated-topic,test (kafka.controller.KafkaController)
[2015-05-30 19:50:38,639] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-05-30 19:50:38,639] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-05-30 19:50:38,639] INFO [Controller 0]: Current list of topics in the cluster: Set(test, my-repilcated-topic, kafkatopic) (kafka.controller.KafkaController)
[2015-05-30 19:50:38,639] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=my-repilcated-topic,Partition=0,Replica=2] -> ReplicaDeletionIneligible, [Topic=kafkatopic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=test,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=my-repilcated-topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=my-repilcated-topic,Partition=0,Replica=1] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2015-05-30 19:50:38,655] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafkatopic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 19:50:38,686] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [my-repilcated-topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 19:50:38,702] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 19:50:38,702] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([kafkatopic,0] -> OfflinePartition, [my-repilcated-topic,0] -> OfflinePartition, [test,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2015-05-30 19:50:38,717] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 7 (kafka.controller.KafkaController)
[2015-05-30 19:50:38,717] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2015-05-30 19:50:38,717] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2015-05-30 19:50:38,733] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2015-05-30 19:50:38,733] INFO [Controller 0]: Controller startup complete (kafka.controller.KafkaController)
[2015-05-30 19:50:38,749] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-05-30 19:50:38,842] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-05-30 19:50:38,920] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2015-05-30 19:50:38,920] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to id:0,host:MININT-4IL6B3T.fareast.corp.microsoft.com,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-05-30 19:50:38,920] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2015-05-30 19:50:38,936] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-05-30 19:50:38,952] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=kafkatopic,Partition=0,Replica=0],[Topic=my-repilcated-topic,Partition=0,Replica=0],[Topic=test,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2015-05-30 19:50:39,017] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafkatopic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 19:50:39,019] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":4,"isr":[0]} for offline partition [kafkatopic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 19:50:39,036] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafkatopic,0] -> (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:7), [my-repilcated-topic,0] -> (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:6), [test,0] -> (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:6)) (kafka.controller.PartitionStateMachine)
[2015-05-30 19:50:39,078] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [my-repilcated-topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 19:50:39,078] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":6,"isr":[0]} for offline partition [my-repilcated-topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 19:50:39,107] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafkatopic,0] -> (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:7), [my-repilcated-topic,0] -> (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:7), [test,0] -> (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:6)) (kafka.controller.PartitionStateMachine)
[2015-05-30 19:50:39,112] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [test,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 19:50:39,112] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":5,"isr":[0]} for offline partition [test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 19:50:39,122] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafkatopic,0] -> (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:7), [my-repilcated-topic,0] -> (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:7), [test,0] -> (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:7)) (kafka.controller.PartitionStateMachine)
[2015-05-30 19:50:43,738] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-05-30 19:50:43,740] DEBUG [Controller 0]: preferred replicas by broker Map(1 -> Map([my-repilcated-topic,0] -> List(1, 2, 0)), 0 -> Map([kafkatopic,0] -> List(0), [test,0] -> List(0))) (kafka.controller.KafkaController)
[2015-05-30 19:50:43,741] DEBUG [Controller 0]: topics not in preferred replica Map([my-repilcated-topic,0] -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2015-05-30 19:50:43,742] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 1.000000 (kafka.controller.KafkaController)
[2015-05-30 19:50:43,743] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-05-30 19:50:43,743] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-05-30 19:50:55,898] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
[2015-05-30 19:51:13,753] INFO [Controller 0]: Controller starting up (kafka.controller.KafkaController)
[2015-05-30 19:51:13,784] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2015-05-30 19:51:13,784] INFO [Controller 0]: Initialized controller epoch to 7 and zk version 6 (kafka.controller.KafkaController)
[2015-05-30 19:51:13,800] INFO [Controller 0]: Controller 0 incremented epoch to 8 (kafka.controller.KafkaController)
[2015-05-30 19:51:13,894] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2015-05-30 19:51:13,894] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2015-05-30 19:51:13,909] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2015-05-30 19:51:13,909] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2015-05-30 19:51:13,909] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2015-05-30 19:51:13,909] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2015-05-30 19:51:13,909] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2015-05-30 19:51:13,909] INFO [Controller 0]: List of topics ineligible for deletion: kafkatopic,my-repilcated-topic,test (kafka.controller.KafkaController)
[2015-05-30 19:51:13,909] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-05-30 19:51:13,909] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-05-30 19:51:13,909] INFO [Controller 0]: Current list of topics in the cluster: Set(test, my-repilcated-topic, kafkatopic) (kafka.controller.KafkaController)
[2015-05-30 19:51:13,925] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=my-repilcated-topic,Partition=0,Replica=2] -> ReplicaDeletionIneligible, [Topic=kafkatopic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=test,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=my-repilcated-topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=my-repilcated-topic,Partition=0,Replica=1] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2015-05-30 19:51:13,941] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafkatopic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 19:51:13,956] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [my-repilcated-topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 19:51:13,972] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 19:51:13,987] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([kafkatopic,0] -> OfflinePartition, [my-repilcated-topic,0] -> OfflinePartition, [test,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2015-05-30 19:51:14,019] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 8 (kafka.controller.KafkaController)
[2015-05-30 19:51:14,019] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2015-05-30 19:51:14,019] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2015-05-30 19:51:14,034] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2015-05-30 19:51:14,034] INFO [Controller 0]: Controller startup complete (kafka.controller.KafkaController)
[2015-05-30 19:51:14,066] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-05-30 19:51:14,097] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-05-30 19:51:14,097] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2015-05-30 19:51:14,097] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to id:0,host:MININT-4IL6B3T.fareast.corp.microsoft.com,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-05-30 19:51:14,097] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-05-30 19:51:14,097] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2015-05-30 19:51:14,112] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=kafkatopic,Partition=0,Replica=0],[Topic=my-repilcated-topic,Partition=0,Replica=0],[Topic=test,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2015-05-30 19:51:14,144] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafkatopic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 19:51:14,159] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":5,"isr":[0]} for offline partition [kafkatopic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 19:51:14,159] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafkatopic,0] -> (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8), [my-repilcated-topic,0] -> (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:7), [test,0] -> (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:7)) (kafka.controller.PartitionStateMachine)
[2015-05-30 19:51:14,159] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [my-repilcated-topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 19:51:14,159] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":7,"isr":[0]} for offline partition [my-repilcated-topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 19:51:14,175] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafkatopic,0] -> (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8), [my-repilcated-topic,0] -> (Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:8), [test,0] -> (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:7)) (kafka.controller.PartitionStateMachine)
[2015-05-30 19:51:14,175] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [test,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 19:51:14,175] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":6,"isr":[0]} for offline partition [test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 19:51:14,191] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafkatopic,0] -> (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:8), [my-repilcated-topic,0] -> (Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:8), [test,0] -> (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8)) (kafka.controller.PartitionStateMachine)
[2015-05-30 19:51:19,050] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-05-30 19:51:19,050] DEBUG [Controller 0]: preferred replicas by broker Map(1 -> Map([my-repilcated-topic,0] -> List(1, 2, 0)), 0 -> Map([kafkatopic,0] -> List(0), [test,0] -> List(0))) (kafka.controller.KafkaController)
[2015-05-30 19:51:19,050] DEBUG [Controller 0]: topics not in preferred replica Map([my-repilcated-topic,0] -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2015-05-30 19:51:19,050] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 1.000000 (kafka.controller.KafkaController)
[2015-05-30 19:51:19,050] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-05-30 19:51:19,050] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-05-30 19:56:19,076] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-05-30 19:56:19,076] DEBUG [Controller 0]: preferred replicas by broker Map(1 -> Map([my-repilcated-topic,0] -> List(1, 2, 0)), 0 -> Map([kafkatopic,0] -> List(0), [test,0] -> List(0))) (kafka.controller.KafkaController)
[2015-05-30 19:56:19,076] DEBUG [Controller 0]: topics not in preferred replica Map([my-repilcated-topic,0] -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2015-05-30 19:56:19,076] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 1.000000 (kafka.controller.KafkaController)
[2015-05-30 19:56:19,076] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-05-30 19:56:19,076] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-05-30 19:57:09,414] INFO [Controller 0]: Controller starting up (kafka.controller.KafkaController)
[2015-05-30 19:57:09,445] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2015-05-30 19:57:09,445] INFO [Controller 0]: Initialized controller epoch to 8 and zk version 7 (kafka.controller.KafkaController)
[2015-05-30 19:57:09,445] INFO [Controller 0]: Controller 0 incremented epoch to 9 (kafka.controller.KafkaController)
[2015-05-30 19:57:09,507] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2015-05-30 19:57:09,507] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2015-05-30 19:57:09,507] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2015-05-30 19:57:09,507] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2015-05-30 19:57:09,507] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2015-05-30 19:57:09,507] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2015-05-30 19:57:09,507] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2015-05-30 19:57:09,523] INFO [Controller 0]: List of topics ineligible for deletion: kafkatopic,my-repilcated-topic,test (kafka.controller.KafkaController)
[2015-05-30 19:57:09,523] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-05-30 19:57:09,523] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-05-30 19:57:09,523] INFO [Controller 0]: Current list of topics in the cluster: Set(test, my-repilcated-topic, kafkatopic) (kafka.controller.KafkaController)
[2015-05-30 19:57:09,523] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=my-repilcated-topic,Partition=0,Replica=2] -> ReplicaDeletionIneligible, [Topic=kafkatopic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=test,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=my-repilcated-topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=my-repilcated-topic,Partition=0,Replica=1] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2015-05-30 19:57:09,539] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafkatopic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 19:57:09,539] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [my-repilcated-topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 19:57:09,554] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 19:57:09,554] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([kafkatopic,0] -> OfflinePartition, [my-repilcated-topic,0] -> OfflinePartition, [test,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2015-05-30 19:57:09,570] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 9 (kafka.controller.KafkaController)
[2015-05-30 19:57:09,570] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2015-05-30 19:57:09,570] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2015-05-30 19:57:09,585] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2015-05-30 19:57:09,585] INFO [Controller 0]: Controller startup complete (kafka.controller.KafkaController)
[2015-05-30 19:57:09,601] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-05-30 19:57:09,664] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-05-30 19:57:09,664] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2015-05-30 19:57:09,757] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to id:0,host:MININT-4IL6B3T.fareast.corp.microsoft.com,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-05-30 19:57:09,773] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2015-05-30 19:57:09,773] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-05-30 19:57:09,794] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=kafkatopic,Partition=0,Replica=0],[Topic=my-repilcated-topic,Partition=0,Replica=0],[Topic=test,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2015-05-30 19:57:09,894] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafkatopic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 19:57:09,895] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":6,"isr":[0]} for offline partition [kafkatopic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 19:57:09,924] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafkatopic,0] -> (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:9), [my-repilcated-topic,0] -> (Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:8), [test,0] -> (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8)) (kafka.controller.PartitionStateMachine)
[2015-05-30 19:57:09,935] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [my-repilcated-topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 19:57:09,935] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":8,"isr":[0]} for offline partition [my-repilcated-topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 19:57:09,939] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafkatopic,0] -> (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:9), [my-repilcated-topic,0] -> (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:9), [test,0] -> (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:8)) (kafka.controller.PartitionStateMachine)
[2015-05-30 19:57:09,946] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [test,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 19:57:09,950] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":7,"isr":[0]} for offline partition [test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 19:57:09,955] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafkatopic,0] -> (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:9), [my-repilcated-topic,0] -> (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:9), [test,0] -> (Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:9)) (kafka.controller.PartitionStateMachine)
[2015-05-30 19:57:14,592] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-05-30 19:57:14,598] DEBUG [Controller 0]: preferred replicas by broker Map(1 -> Map([my-repilcated-topic,0] -> List(1, 2, 0)), 0 -> Map([kafkatopic,0] -> List(0), [test,0] -> List(0))) (kafka.controller.KafkaController)
[2015-05-30 19:57:14,603] DEBUG [Controller 0]: topics not in preferred replica Map([my-repilcated-topic,0] -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2015-05-30 19:57:14,607] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 1.000000 (kafka.controller.KafkaController)
[2015-05-30 19:57:14,609] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-05-30 19:57:14,609] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-05-30 20:02:14,608] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-05-30 20:02:14,608] DEBUG [Controller 0]: preferred replicas by broker Map(1 -> Map([my-repilcated-topic,0] -> List(1, 2, 0)), 0 -> Map([kafkatopic,0] -> List(0), [test,0] -> List(0))) (kafka.controller.KafkaController)
[2015-05-30 20:02:14,608] DEBUG [Controller 0]: topics not in preferred replica Map([my-repilcated-topic,0] -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2015-05-30 20:02:14,608] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 1.000000 (kafka.controller.KafkaController)
[2015-05-30 20:02:14,608] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-05-30 20:02:14,608] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-05-30 20:07:40,662] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
[2015-05-30 20:07:57,090] INFO [Controller 0]: Controller starting up (kafka.controller.KafkaController)
[2015-05-30 20:07:57,106] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2015-05-30 20:07:57,106] INFO [Controller 0]: Initialized controller epoch to 9 and zk version 8 (kafka.controller.KafkaController)
[2015-05-30 20:07:57,122] INFO [Controller 0]: Controller 0 incremented epoch to 10 (kafka.controller.KafkaController)
[2015-05-30 20:07:57,168] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2015-05-30 20:07:57,168] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2015-05-30 20:07:57,168] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2015-05-30 20:07:57,184] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2015-05-30 20:07:57,184] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2015-05-30 20:07:57,184] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2015-05-30 20:07:57,184] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2015-05-30 20:07:57,184] INFO [Controller 0]: List of topics ineligible for deletion: kafkatopic,my-repilcated-topic,test (kafka.controller.KafkaController)
[2015-05-30 20:07:57,184] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-05-30 20:07:57,184] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-05-30 20:07:57,184] INFO [Controller 0]: Current list of topics in the cluster: Set(test, my-repilcated-topic, kafkatopic) (kafka.controller.KafkaController)
[2015-05-30 20:07:57,184] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=my-repilcated-topic,Partition=0,Replica=2] -> ReplicaDeletionIneligible, [Topic=kafkatopic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=test,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=my-repilcated-topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=my-repilcated-topic,Partition=0,Replica=1] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2015-05-30 20:07:57,200] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafkatopic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 20:07:57,215] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [my-repilcated-topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 20:07:57,215] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 20:07:57,231] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([kafkatopic,0] -> OfflinePartition, [my-repilcated-topic,0] -> OfflinePartition, [test,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2015-05-30 20:07:57,231] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 10 (kafka.controller.KafkaController)
[2015-05-30 20:07:57,231] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2015-05-30 20:07:57,231] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2015-05-30 20:07:57,247] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2015-05-30 20:07:57,247] INFO [Controller 0]: Controller startup complete (kafka.controller.KafkaController)
[2015-05-30 20:07:57,262] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-05-30 20:07:57,293] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-05-30 20:07:57,293] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2015-05-30 20:07:57,309] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to id:0,host:MININT-4IL6B3T.fareast.corp.microsoft.com,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-05-30 20:07:57,309] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-05-30 20:07:57,309] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2015-05-30 20:07:57,309] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=kafkatopic,Partition=0,Replica=0],[Topic=my-repilcated-topic,Partition=0,Replica=0],[Topic=test,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2015-05-30 20:07:57,356] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafkatopic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 20:07:57,356] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":7,"isr":[0]} for offline partition [kafkatopic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 20:07:57,372] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafkatopic,0] -> (Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:10), [my-repilcated-topic,0] -> (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:9), [test,0] -> (Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:9)) (kafka.controller.PartitionStateMachine)
[2015-05-30 20:07:57,387] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [my-repilcated-topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 20:07:57,387] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":9,"isr":[0]} for offline partition [my-repilcated-topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 20:07:57,387] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafkatopic,0] -> (Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:10), [my-repilcated-topic,0] -> (Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:10), [test,0] -> (Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:9)) (kafka.controller.PartitionStateMachine)
[2015-05-30 20:07:57,387] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [test,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 20:07:57,387] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":8,"isr":[0]} for offline partition [test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 20:07:57,403] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafkatopic,0] -> (Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:10), [my-repilcated-topic,0] -> (Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:10), [test,0] -> (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:10)) (kafka.controller.PartitionStateMachine)
[2015-05-30 20:08:02,262] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-05-30 20:08:02,262] DEBUG [Controller 0]: preferred replicas by broker Map(1 -> Map([my-repilcated-topic,0] -> List(1, 2, 0)), 0 -> Map([kafkatopic,0] -> List(0), [test,0] -> List(0))) (kafka.controller.KafkaController)
[2015-05-30 20:08:02,278] DEBUG [Controller 0]: topics not in preferred replica Map([my-repilcated-topic,0] -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2015-05-30 20:08:02,278] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 1.000000 (kafka.controller.KafkaController)
[2015-05-30 20:08:02,278] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-05-30 20:08:02,278] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-05-30 20:12:05,410] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
[2015-05-30 20:12:35,894] INFO [Controller 0]: Controller starting up (kafka.controller.KafkaController)
[2015-05-30 20:12:35,944] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2015-05-30 20:12:35,953] INFO [Controller 0]: Initialized controller epoch to 10 and zk version 9 (kafka.controller.KafkaController)
[2015-05-30 20:12:35,965] INFO [Controller 0]: Controller 0 incremented epoch to 11 (kafka.controller.KafkaController)
[2015-05-30 20:12:36,083] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2015-05-30 20:12:36,083] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2015-05-30 20:12:36,084] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2015-05-30 20:12:36,088] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2015-05-30 20:12:36,089] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2015-05-30 20:12:36,090] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2015-05-30 20:12:36,099] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2015-05-30 20:12:36,100] INFO [Controller 0]: List of topics ineligible for deletion: kafkatopic,my-repilcated-topic,test (kafka.controller.KafkaController)
[2015-05-30 20:12:36,104] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-05-30 20:12:36,105] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-05-30 20:12:36,106] INFO [Controller 0]: Current list of topics in the cluster: Set(test, my-repilcated-topic, kafkatopic) (kafka.controller.KafkaController)
[2015-05-30 20:12:36,112] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=my-repilcated-topic,Partition=0,Replica=2] -> ReplicaDeletionIneligible, [Topic=kafkatopic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=test,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=my-repilcated-topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=my-repilcated-topic,Partition=0,Replica=1] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2015-05-30 20:12:36,133] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafkatopic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 20:12:36,169] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [my-repilcated-topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 20:12:36,187] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 20:12:36,193] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([kafkatopic,0] -> OfflinePartition, [my-repilcated-topic,0] -> OfflinePartition, [test,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2015-05-30 20:12:36,200] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 11 (kafka.controller.KafkaController)
[2015-05-30 20:12:36,201] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2015-05-30 20:12:36,203] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2015-05-30 20:12:36,231] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2015-05-30 20:12:36,233] INFO [Controller 0]: Controller startup complete (kafka.controller.KafkaController)
[2015-05-30 20:12:36,270] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-05-30 20:12:36,337] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-05-30 20:12:36,345] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2015-05-30 20:12:36,395] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to id:0,host:MININT-4IL6B3T.fareast.corp.microsoft.com,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-05-30 20:12:36,397] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2015-05-30 20:12:36,417] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-05-30 20:12:36,434] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=kafkatopic,Partition=0,Replica=0],[Topic=my-repilcated-topic,Partition=0,Replica=0],[Topic=test,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2015-05-30 20:12:36,477] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafkatopic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 20:12:36,478] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":8,"isr":[0]} for offline partition [kafkatopic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 20:12:36,493] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafkatopic,0] -> (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:11), [my-repilcated-topic,0] -> (Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:10), [test,0] -> (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:10)) (kafka.controller.PartitionStateMachine)
[2015-05-30 20:12:36,506] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [my-repilcated-topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 20:12:36,506] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":10,"isr":[0]} for offline partition [my-repilcated-topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 20:12:36,527] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafkatopic,0] -> (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:11), [my-repilcated-topic,0] -> (Leader:0,ISR:0,LeaderEpoch:10,ControllerEpoch:11), [test,0] -> (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:10)) (kafka.controller.PartitionStateMachine)
[2015-05-30 20:12:36,539] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [test,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 20:12:36,539] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":9,"isr":[0]} for offline partition [test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 20:12:36,546] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafkatopic,0] -> (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:11), [my-repilcated-topic,0] -> (Leader:0,ISR:0,LeaderEpoch:10,ControllerEpoch:11), [test,0] -> (Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:11)) (kafka.controller.PartitionStateMachine)
[2015-05-30 20:12:41,242] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-05-30 20:12:41,242] DEBUG [Controller 0]: preferred replicas by broker Map(1 -> Map([my-repilcated-topic,0] -> List(1, 2, 0)), 0 -> Map([kafkatopic,0] -> List(0), [test,0] -> List(0))) (kafka.controller.KafkaController)
[2015-05-30 20:12:41,242] DEBUG [Controller 0]: topics not in preferred replica Map([my-repilcated-topic,0] -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2015-05-30 20:12:41,242] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 1.000000 (kafka.controller.KafkaController)
[2015-05-30 20:12:41,242] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-05-30 20:12:41,242] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-05-30 20:17:41,249] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-05-30 20:17:41,249] DEBUG [Controller 0]: preferred replicas by broker Map(1 -> Map([my-repilcated-topic,0] -> List(1, 2, 0)), 0 -> Map([kafkatopic,0] -> List(0), [test,0] -> List(0))) (kafka.controller.KafkaController)
[2015-05-30 20:17:41,249] DEBUG [Controller 0]: topics not in preferred replica Map([my-repilcated-topic,0] -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2015-05-30 20:17:41,249] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 1.000000 (kafka.controller.KafkaController)
[2015-05-30 20:17:41,249] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-05-30 20:17:41,249] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2015-05-30 20:19:30,450] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
[2015-05-30 20:19:47,345] INFO [Controller 0]: Controller starting up (kafka.controller.KafkaController)
[2015-05-30 20:19:47,376] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2015-05-30 20:19:47,376] INFO [Controller 0]: Initialized controller epoch to 11 and zk version 10 (kafka.controller.KafkaController)
[2015-05-30 20:19:47,392] INFO [Controller 0]: Controller 0 incremented epoch to 12 (kafka.controller.KafkaController)
[2015-05-30 20:19:47,439] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2015-05-30 20:19:47,439] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2015-05-30 20:19:47,439] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2015-05-30 20:19:47,439] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2015-05-30 20:19:47,439] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2015-05-30 20:19:47,455] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2015-05-30 20:19:47,455] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2015-05-30 20:19:47,455] INFO [Controller 0]: List of topics ineligible for deletion: kafkatopic,my-repilcated-topic,test (kafka.controller.KafkaController)
[2015-05-30 20:19:47,455] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-05-30 20:19:47,455] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2015-05-30 20:19:47,455] INFO [Controller 0]: Current list of topics in the cluster: Set(test, my-repilcated-topic, kafkatopic) (kafka.controller.KafkaController)
[2015-05-30 20:19:47,455] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=my-repilcated-topic,Partition=0,Replica=2] -> ReplicaDeletionIneligible, [Topic=kafkatopic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=test,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=my-repilcated-topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=my-repilcated-topic,Partition=0,Replica=1] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2015-05-30 20:19:47,470] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafkatopic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 20:19:47,486] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [my-repilcated-topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 20:19:47,501] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 20:19:47,501] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([kafkatopic,0] -> OfflinePartition, [my-repilcated-topic,0] -> OfflinePartition, [test,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2015-05-30 20:19:47,501] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 12 (kafka.controller.KafkaController)
[2015-05-30 20:19:47,501] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2015-05-30 20:19:47,501] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2015-05-30 20:19:47,517] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2015-05-30 20:19:47,517] INFO [Controller 0]: Controller startup complete (kafka.controller.KafkaController)
[2015-05-30 20:19:47,548] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-05-30 20:19:47,564] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2015-05-30 20:19:47,564] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2015-05-30 20:19:47,580] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to id:0,host:MININT-4IL6B3T.fareast.corp.microsoft.com,port:9092 for sending state change requests (kafka.controller.RequestSendThread)
[2015-05-30 20:19:47,580] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2015-05-30 20:19:47,580] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2015-05-30 20:19:47,595] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=kafkatopic,Partition=0,Replica=0],[Topic=my-repilcated-topic,Partition=0,Replica=0],[Topic=test,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2015-05-30 20:19:47,642] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafkatopic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 20:19:47,658] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":9,"isr":[0]} for offline partition [kafkatopic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 20:19:47,705] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafkatopic,0] -> (Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:12), [my-repilcated-topic,0] -> (Leader:0,ISR:0,LeaderEpoch:10,ControllerEpoch:11), [test,0] -> (Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:11)) (kafka.controller.PartitionStateMachine)
[2015-05-30 20:19:47,720] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [my-repilcated-topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 20:19:47,720] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":11,"isr":[0]} for offline partition [my-repilcated-topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 20:19:47,720] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafkatopic,0] -> (Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:12), [my-repilcated-topic,0] -> (Leader:0,ISR:0,LeaderEpoch:11,ControllerEpoch:12), [test,0] -> (Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:11)) (kafka.controller.PartitionStateMachine)
[2015-05-30 20:19:47,767] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [test,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 20:19:47,767] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":10,"isr":[0]} for offline partition [test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2015-05-30 20:19:47,783] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafkatopic,0] -> (Leader:0,ISR:0,LeaderEpoch:9,ControllerEpoch:12), [my-repilcated-topic,0] -> (Leader:0,ISR:0,LeaderEpoch:11,ControllerEpoch:12), [test,0] -> (Leader:0,ISR:0,LeaderEpoch:10,ControllerEpoch:12)) (kafka.controller.PartitionStateMachine)
[2015-05-30 20:19:52,533] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2015-05-30 20:19:52,533] DEBUG [Controller 0]: preferred replicas by broker Map(1 -> Map([my-repilcated-topic,0] -> List(1, 2, 0)), 0 -> Map([kafkatopic,0] -> List(0), [test,0] -> List(0))) (kafka.controller.KafkaController)
[2015-05-30 20:19:52,549] DEBUG [Controller 0]: topics not in preferred replica Map([my-repilcated-topic,0] -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2015-05-30 20:19:52,549] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 1.000000 (kafka.controller.KafkaController)
[2015-05-30 20:19:52,549] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2015-05-30 20:19:52,549] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
